CREATE TABLE BOOKS_AUD (
  EVENT_ID INT(11) NOT NULL AUTO_INCREMENT,
  EVENT_DATE DATETIME NOT NULL,
  EVENT_TYPE VARCHAR(10) DEFAULT NULL,
  NEW_BOOK_ID INT(11),
  OLD_BOOK_ID INT(11),
  NEW_TITLE VARCHAR(40),
  OLD_TITLE VARCHAR(40),
  NEW_PUBYEAR INT,
  OLD_PUBYEAR INT,
  PRIMARY KEY (`EVENT_ID`)
);

CREATE TABLE READERS_AUD (
  EVENT_ID INT(11) NOT NULL AUTO_INCREMENT,
  EVENT_DATE DATETIME NOT NULL,
  EVENT_TYPE VARCHAR(10) DEFAULT NULL,
  NEW_READER_ID INT(11),
  OLD_READER_ID INT(11),
  NEW_FIRSTNAME VARCHAR(40),
  OLD_FIRSTNAME VARCHAR(40),
  NEW_LASTNAME VARCHAR(40),
  OLD_LASTNAME VARCHAR(40),
  NEW_PESEL_ID VARCHAR(11),
  OLD_PESEL_ID VARCHAR(11),
  PRIMARY KEY (`EVENT_ID`)
);

DELIMITER $$
CREATE TRIGGER BOOKS_INSERT AFTER INSERT ON BOOKS
FOR EACH ROW
BEGIN
  INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, NEW_BOOK_ID, NEW_TITLE, NEW_PUBYEAR)
  VALUES(CURTIME(), "INSERT", NEW.BOOK_ID, NEW.TITLE, NEW.PUBYEAR);
 END $$
DELIMITER ;


DELIMITER $$
CREATE TRIGGER BOOKS_DELETE AFTER DELETE ON BOOKS
FOR EACH ROW
BEGIN
  INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, OLD_BOOK_ID)
  VALUES(CURTIME(), "DELETE", OLD.BOOK_ID);       
END $$
DELIMITER ;


DELIMITER $$
CREATE TRIGGER BOOKS_UPDATE AFTER UPDATE ON BOOKS
FOR EACH ROW
BEGIN
  INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, NEW_BOOK_ID, OLD_BOOK_ID,  NEW_TITLE, OLD_TITLE, NEW_PUBYEAR, OLD_PUBYEAR)
  VALUES(CURTIME(), "UPDATE", NEW.BOOK_ID, OLD.BOOK_ID, NEW.TITLE, OLD.TITLE, NEW.PUBYEAR, OLD.PUBYEAR);   
END $$
DELIMITER ;





DELIMITER $$
CREATE TRIGGER READERS_INSERT AFTER INSERT ON READERS
FOR EACH ROW
BEGIN
  INSERT INTO READERS_AUD (EVENT_DATE, EVENT_TYPE, NEW_READER_ID, NEW_FIRSTNAME, NEW_LASTNAME, NEW_PESEL_ID, OLD_PESEL_ID)
  VALUES(CURTIME(), "INSERT", NEW.READER_ID, NEW.FIRSTNAME, NEW.LASTNAME, NEW.PESEL_ID);
END $$
DELIMITER ;


DELIMITER $$
CREATE TRIGGER READERS_DELETE AFTER DELETE ON READERS
FOR EACH ROW
BEGIN
  INSERT INTO READERS_AUD (EVENT_DATE, EVENT_TYPE, OLD_READER_ID)
  VALUES(CURTIME(), "DELETE", OLD.READER_ID);
END $$
DELIMITER ;


DELIMITER $$
CREATE TRIGGER READERS_UPDATE AFTER UPDATE ON READERS
FOR EACH ROW
BEGIN
  INSERT INTO READERS_AUD (EVENT_DATE, EVENT_TYPE, NEW_READER_ID, OLD_READER_ID, NEW_FIRSTNAME, OLD_FIRSTNAME, NEW_LASTNAME, OLD_LASTNAME, NEW_PESEL_ID, OLD_PESEL_ID)
  VALUES(CURTIME(), "UPDATE", NEW.READER_ID, OLD.READER_ID, NEW.FIRSTNAME, OLD.FIRSTNAME, NEW.LASTNAME, OLD.LASTNAME, NEW.PESEL_ID, OLD.PESEL_ID);
END $$
DELIMITER ;



